diff -up onig-6.8.2/src/regext.c.orig onig-6.8.2/src/regext.c
--- onig-6.8.2/src/regext.c.orig	2017-12-11 01:08:17.000000000 +0100
+++ onig-6.8.2/src/regext.c	2023-10-30 11:10:45.018894014 +0100
@@ -196,7 +196,13 @@ onig_new_deluxe(regex_t** reg, const UCh
   }
 
  err2:
-  if (cpat != pattern) xfree(cpat);
+  if (cpat != pattern) {
+    xfree(cpat);
+    if (r) {
+      einfo->par = (UChar* )NULL;
+      einfo->par_end = (UChar* )NULL;
+    }
+  }
 
   return r;
 }
